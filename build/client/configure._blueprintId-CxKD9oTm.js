import{r as p,u as _,a as C,j as e,F as k,w as I,L as F}from"./chunk-JZWAC4HX-bs4pZpVQ.js";import{u as E}from"./index-DGVGBDgr.js";import{f as T,i as L,T as N,a as B,E as O,b as $,N as D,c as z,d as A,B as M,e as q,S as V,g as P,h as R,j as W}from"./NotificationInput-BS9H4_Gc.js";function J({blueprint:a,blueprintId:s,defaultInstanceName:i,isEditing:l=!1,availableCategories:r=[]}){const[t,d]=p.useState([]),[o,u]=p.useState(""),m=_(),h=C();p.useEffect(()=>{m?.success&&h("/")},[m,h]);const b={_instanceName:i||s.replace(/-/g,"_")},y=T(a.input);for(const[n,c]of Object.entries(y))c.default!==void 0&&(b[n]=c.default);const{register:f,control:w,handleSubmit:S,formState:{errors:x,isSubmitting:j},reset:g}=E({defaultValues:b,submitConfig:{method:"POST"}});return p.useEffect(()=>{g(b)},[s,g]),e.jsxs(k,{method:"post",onSubmit:S,children:[e.jsx("input",{type:"hidden",name:"blueprintId",value:s}),e.jsx("div",{className:"pb-4 mb-4 border-b border-base-300",children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{htmlFor:"_instanceName",className:"block text-sm font-medium text-base-content",children:["Instance Name",e.jsx("span",{className:"text-error ml-1",children:"*"})]}),e.jsx("input",{type:"text",id:"_instanceName",placeholder:s.replace(/-/g,"_"),className:`input input-bordered input-sm w-full font-mono text-sm bg-base-200 border-base-300 focus:border-primary ${x._instanceName?"input-error":""}`,...f("_instanceName",{required:"Instance name is required",pattern:{value:/^[a-z][a-z0-9_]*$/,message:"Must start with letter, use only lowercase letters, numbers, and underscores"}})}),x._instanceName?e.jsx("p",{className:"text-xs text-error",children:x._instanceName.message}):e.jsx("p",{className:"text-xs text-base-content/50",children:"Unique identifier for this app instance in apps.yaml"})]})}),e.jsxs("div",{className:"pb-4 mb-4 border-b border-base-300 space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"_category",className:"block text-sm font-medium text-base-content",children:"Category"}),e.jsxs("select",{id:"_category",className:"select select-bordered select-sm w-full bg-base-200 border-base-300 focus:border-primary",...f("_category"),children:[e.jsx("option",{value:"",children:"No category"}),r.map(n=>e.jsx("option",{value:n,children:n},n))]}),e.jsx("p",{className:"text-xs text-base-content/50",children:"Organize instances by category (configure in Settings)"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-base-content",children:"Tags"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:n=>u(n.target.value),onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),o.trim()&&!t.includes(o.trim())&&(d([...t,o.trim()]),u("")))},placeholder:"Add tag...",className:"input input-bordered input-sm flex-1 bg-base-200 border-base-300 focus:border-primary"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>{o.trim()&&!t.includes(o.trim())&&(d([...t,o.trim()]),u(""))},children:"Add"})]}),t.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:t.map(n=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded bg-base-200 text-base-content/70 text-xs",children:[n,e.jsx("button",{type:"button",onClick:()=>d(t.filter(c=>c!==n)),className:"hover:bg-base-300 rounded-full p-0.5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},n))}),e.jsx("input",{type:"hidden",name:"_tags",value:JSON.stringify(t)}),e.jsx("p",{className:"text-xs text-base-content/50",children:"Free-form tags for filtering and organization"})]})]}),m?.error&&e.jsx("div",{className:"mb-4 p-3 rounded-lg border border-error/30 bg-error/5 text-error text-sm",children:m.error}),e.jsx("div",{className:"divide-y divide-base-300",children:a.input&&Object.entries(a.input).map(([n,c])=>e.jsx(v,{itemKey:n,item:c,register:f,control:w,errors:x},n))}),!a.input&&e.jsx("div",{className:"py-8 text-center text-base-content/50",children:"No configuration options available for this blueprint."}),e.jsx("div",{className:"pt-4 border-t border-base-300",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Saving..."]}):e.jsxs(e.Fragment,{children:["Save Configuration",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})})]})}function v({itemKey:a,item:s,register:i,control:l,errors:r}){return L(s)?e.jsx("div",{className:"py-4 first:pt-0 last:pb-0",children:e.jsxs("details",{className:"group collapse collapse-arrow bg-base-100 border border-base-300 rounded-lg",children:[e.jsxs("summary",{className:"collapse-title text-base font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.icon&&e.jsx("span",{className:`mdi ${s.icon}`}),s.name]}),s.description&&e.jsx("div",{className:"text-xs font-normal text-base-content/60 mt-0.5",children:s.description})]}),e.jsx("div",{className:"collapse-content",children:e.jsx("div",{className:"divide-y divide-base-300",children:Object.entries(s.input).map(([t,d])=>e.jsx(v,{itemKey:t,item:d,register:i,control:l,errors:r},t))})})]})}):e.jsx("div",{className:"py-4 first:pt-0 last:pb-0",children:e.jsx(U,{inputKey:a,input:s,register:i,control:l,errors:r})})}function U({inputKey:a,input:s,register:i,control:l,errors:r}){const t=s.selector;return t?B(t)?e.jsx(O,{name:a,label:s.name,description:s.description,register:i,errors:r,domain:t.entity.domain,deviceClass:t.entity.device_class,multiple:t.entity.multiple}):$(t)?e.jsx(D,{name:a,label:s.name,description:s.description,control:l,errors:r,min:t.number.min,max:t.number.max,step:t.number.step,unit:t.number.unit_of_measurement,mode:t.number.mode,defaultValue:s.default}):z(t)?e.jsx(N,{name:a,label:s.name,description:s.description,register:i,errors:r,multiline:t.text.multiline,type:t.text.type}):A(t)?e.jsx(M,{name:a,label:s.name,description:s.description,control:l,defaultValue:s.default}):q(t)?e.jsx(V,{name:a,label:s.name,description:s.description,register:i,errors:r,options:t.select.options,multiple:t.select.multiple}):P(t)?e.jsx(R,{name:a,label:s.name,description:s.description,register:i,errors:r}):e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"block text-sm font-medium text-base-content",children:[s.name,e.jsxs("span",{className:"text-xs text-warning ml-2",children:["(unsupported: ",W(t),")"]})]}),e.jsx("input",{type:"text",className:"input input-bordered input-sm w-full bg-base-200 border-base-300",...i(a)}),s.description&&e.jsx("p",{className:"text-xs text-base-content/50",children:s.description})]}):e.jsx(N,{name:a,label:s.name,description:s.description,register:i,errors:r})}function X({data:a}){const s=a?.blueprint?.blueprint?.name??"Configure";return[{title:`${s} | AppDaemon Configurator`},{name:"description",content:`Configure ${s} blueprint`}]}const Y=I(function({loaderData:s}){const{blueprint:i,blueprintId:l,categories:r}=s;return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-base-content/50 mb-2",children:[e.jsx(F,{to:"/",className:"hover:text-base-content",children:"Blueprints"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-base-content",children:i.blueprint.name})]}),e.jsx("h1",{className:"text-xl font-semibold",children:i.blueprint.name}),e.jsx("p",{className:"text-sm text-base-content/50 mt-1",children:i.blueprint.description})]}),e.jsx("div",{className:"rounded-lg border border-base-300 bg-base-100 p-4",children:e.jsx(J,{blueprint:i,blueprintId:l,availableCategories:r})})]})});export{Y as default,X as meta};
