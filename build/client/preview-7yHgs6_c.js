import{r as o,a as S,j as e,L as j,w as C}from"./chunk-JZWAC4HX-bs4pZpVQ.js";function k({yaml:i,blueprintId:s,blueprintName:x,instanceName:l,config:c,hasAppdaemonPath:t,category:d,tags:p}){const[n,r]=o.useState(!1),[h,u]=o.useState(!1),[g,b]=o.useState(null),[m,v]=o.useState(!1),y=S(),f=async()=>{try{await navigator.clipboard.writeText(i),r(!0),setTimeout(()=>r(!1),2e3)}catch(a){console.error("Failed to copy:",a)}},w=async()=>{u(!0),b(null);try{const a=await fetch("/api/instances/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blueprintId:s,instanceName:l,config:c,category:d,tags:p})}),N=await a.json();if(!a.ok)throw new Error(N.error||"Failed to save instance");v(!0),setTimeout(()=>{y("/instances")},1500)}catch(a){b(a.message)}finally{u(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Generated Configuration"}),e.jsx("p",{className:"text-sm text-base-content/50",children:"Save to apps.yaml or copy manually"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{to:`/configure/${s}`,className:"btn btn-ghost btn-sm",children:"‚Üê Back"}),e.jsx("button",{onClick:f,className:`btn btn-sm ${n?"btn-success":"btn-ghost"}`,children:n?"Copied!":"Copy"}),t?e.jsx("button",{onClick:w,disabled:h||m,className:`btn btn-sm ${m?"btn-success":"btn-primary"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Saving..."]}):m?e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved!"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save to apps.yaml"]})}):e.jsx(j,{to:"/settings",className:"btn btn-sm btn-primary",children:"Configure Path"})]})]}),g&&e.jsx("div",{className:"p-3 rounded-lg border border-error/30 bg-error/5 text-error text-sm",children:g}),!t&&e.jsx("div",{className:"p-3 rounded-lg border border-warning/30 bg-warning/5 text-warning text-sm",children:"Configure your AppDaemon apps folder path in Settings to save directly to apps.yaml."}),e.jsxs("div",{className:"rounded-lg border border-base-300 bg-base-200 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 border-b border-base-300 bg-base-300/50",children:e.jsx("span",{className:"text-xs text-base-content/50 font-mono",children:"apps.yaml"})}),e.jsx("pre",{className:"p-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm font-mono text-base-content",children:i})})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-base-200/50 border border-base-300",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Next Steps"}),e.jsx("ol",{className:"text-xs text-base-content/60 space-y-1 list-decimal list-inside",children:t?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:'Click "Save to apps.yaml" to add this configuration automatically'}),e.jsxs("li",{children:["Ensure ",e.jsxs("code",{className:"bg-base-200 px-1 py-0.5 rounded",children:[s.replace(/-/g,"_"),".py"]})," exists in your apps folder"]}),e.jsx("li",{children:"Restart AppDaemon to load the configuration"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("li",{children:["Copy the configuration above to your AppDaemon ",e.jsx("code",{className:"bg-base-200 px-1 py-0.5 rounded",children:"apps.yaml"})]}),e.jsxs("li",{children:["Ensure ",e.jsxs("code",{className:"bg-base-200 px-1 py-0.5 rounded",children:[s.replace(/-/g,"_"),".py"]})," exists in your apps folder"]}),e.jsx("li",{children:"Restart AppDaemon to load the configuration"})]})})]})]})}function F({}){return[{title:"Preview | AppDaemon Configurator"},{name:"description",content:"Preview generated apps.yaml configuration"}]}const L=C(function({loaderData:s}){const{yaml:x,blueprintId:l,blueprintName:c,instanceName:t,config:d,hasAppdaemonPath:p,category:n,tags:r}=s;return e.jsx("div",{className:"max-w-2xl mx-auto px-4 py-8",children:e.jsx(k,{yaml:x,blueprintId:l,blueprintName:c,instanceName:t,config:d,hasAppdaemonPath:p,category:n,tags:r})})});export{L as default,F as meta};
