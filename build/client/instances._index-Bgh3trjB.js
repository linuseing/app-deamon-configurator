import{j as e,L as p,r,w as k,l as C}from"./chunk-JZWAC4HX-bs4pZpVQ.js";function L({instance:s,onDelete:a}){return e.jsxs("div",{className:"flex flex-col h-full p-4 rounded-lg border border-base-300 bg-base-100 hover:border-primary/50 hover:bg-base-200/30 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-base-content truncate font-mono text-sm",children:s.id}),e.jsxs("p",{className:"text-sm text-base-content/50 mt-1 truncate",children:[s.blueprintName?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary/70",children:s.blueprintName}),e.jsx("span",{className:"text-base-content/30 mx-1",children:"â€¢"})]}):null,e.jsxs("span",{className:"font-mono text-xs",children:[s.module,".",s.class]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.blueprintId?e.jsx(p,{to:`/instances/${s.id}/edit`,className:"btn btn-ghost btn-xs",title:"Edit instance",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}):null,a&&e.jsx("button",{onClick:()=>a(s.id),className:"btn btn-ghost btn-xs text-error hover:bg-error/10",title:"Delete instance",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.tags.map(n=>e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-base-200 text-base-content/60 text-[10px]",children:n},n))}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mt-3 text-xs text-base-content/40",children:[s.category&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-secondary/15 text-secondary font-medium",children:s.category}),s.blueprintId?e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-primary/10 text-primary/70 truncate max-w-full",children:s.blueprintId}):e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-base-200 text-base-content/60",children:"manual"}),e.jsxs("span",{children:[s.configCount," settings"]})]})]})}function M({instances:s,onDelete:a}){return s.length===0?e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-lg bg-base-200 mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-base-content/40",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-base font-medium mb-1",children:"No app instances found"}),e.jsxs("p",{className:"text-sm text-base-content/50 max-w-sm mx-auto mb-4",children:["Create your first app instance from a blueprint, or add apps directly to your"," ",e.jsx("code",{className:"text-xs bg-base-200 px-1 py-0.5 rounded",children:"apps.yaml"})," file."]}),e.jsx(p,{to:"/",className:"btn btn-primary btn-sm",children:"Browse Blueprints"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(n=>e.jsx(L,{instance:n,onDelete:a},n.id))})}function A({isOpen:s,instanceId:a,onConfirm:n,onCancel:d,isDeleting:o=!1}){const i=r.useRef(null);return r.useEffect(()=>{s?i.current?.showModal():i.current?.close()},[s]),e.jsxs("dialog",{ref:i,className:"modal",onClose:d,children:[e.jsxs("div",{className:"modal-box max-w-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-error/10 flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-error",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-base",children:"Delete Instance"}),e.jsx("p",{className:"text-sm text-base-content/60",children:"This action cannot be undone"})]})]}),e.jsxs("p",{className:"text-sm text-base-content/80 mb-4",children:["Are you sure you want to delete"," ",e.jsx("code",{className:"bg-base-200 px-1.5 py-0.5 rounded font-mono text-xs",children:a}),"? This will remove the configuration from your apps.yaml file."]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:d,disabled:o,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-error btn-sm",onClick:n,disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Deleting..."]}):"Delete"})]})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{type:"button",onClick:d,children:"close"})})]})}function D({}){return[{title:"Instances | AppDaemon Configurator"},{name:"description",content:"Manage your configured app instances"}]}const _=k(function({loaderData:a}){const{instances:n,needsSettings:d,error:o,categories:i}=a,l=C(),[x,u]=r.useState(null),[c,b]=r.useState(""),[m,g]=r.useState(""),j=t=>{u(t)},v=()=>{x&&l.submit({intent:"delete",instanceId:x},{method:"POST"})};r.useEffect(()=>{l.state==="idle"&&l.data?.success&&u(null)},[l.state,l.data]);const N=r.useMemo(()=>{const t=new Set;return n.forEach(h=>{h.tags?.forEach(y=>t.add(y))}),Array.from(t).sort()},[n]),f=r.useMemo(()=>n.filter(t=>{if(c){if(c==="__none__"){if(t.category)return!1}else if(t.category!==c)return!1}return!(m&&!t.tags?.includes(m))}),[n,c,m]),w=r.useMemo(()=>{const t=new Set(i);return n.forEach(h=>{h.category&&t.add(h.category)}),Array.from(t).sort()},[n,i]);return d?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"App Instances"}),e.jsx("p",{className:"text-sm text-base-content/50 mt-1",children:"Manage your configured AppDaemon apps"})]}),e.jsxs("div",{className:"rounded-lg border border-warning/30 bg-warning/5 p-6 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-lg bg-warning/10 mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-warning",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-base font-medium mb-2",children:"AppDaemon Path Required"}),e.jsx("p",{className:"text-sm text-base-content/60 mb-4",children:"Configure your AppDaemon apps folder path in settings to view and manage instances."}),e.jsx(p,{to:"/settings",className:"btn btn-warning btn-sm",children:"Go to Settings"})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"App Instances"}),e.jsx("p",{className:"text-sm text-base-content/50 mt-1",children:"Manage your configured AppDaemon apps"})]}),e.jsxs(p,{to:"/",className:"btn btn-primary btn-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Instance"]})]}),o&&e.jsx("div",{className:"mb-4 p-3 rounded-lg border border-error/30 bg-error/5 text-error text-sm",children:o}),l.data?.error&&e.jsx("div",{className:"mb-4 p-3 rounded-lg border border-error/30 bg-error/5 text-error text-sm",children:l.data.error}),n.length>0&&e.jsxs("div",{className:"mb-4 flex flex-wrap gap-3 items-center p-3 rounded-lg border border-base-300 bg-base-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-base-content/70",children:"Category:"}),e.jsxs("select",{value:c,onChange:t=>b(t.target.value),className:"select select-bordered select-sm bg-base-200 border-base-300 min-w-[140px]",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"__none__",children:"Uncategorized"}),w.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-base-content/70",children:"Tag:"}),e.jsxs("select",{value:m,onChange:t=>g(t.target.value),className:"select select-bordered select-sm bg-base-200 border-base-300 min-w-[140px]",children:[e.jsx("option",{value:"",children:"All"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),(c||m)&&e.jsx("button",{onClick:()=>{b(""),g("")},className:"btn btn-ghost btn-xs text-base-content/60",children:"Clear filters"}),e.jsx("div",{className:"flex-1"}),e.jsxs("span",{className:"text-xs text-base-content/50",children:[f.length," of ",n.length," instances"]})]}),e.jsx(M,{instances:f,onDelete:j}),e.jsx(A,{isOpen:!!x,instanceId:x??"",onConfirm:v,onCancel:()=>u(null),isDeleting:l.state==="submitting"})]})});export{_ as default,D as meta};
